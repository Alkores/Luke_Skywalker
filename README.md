# Luke_Skywalker
–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –∫–æ–º–∞–Ω–¥–æ–π Luke_Skywalker –¥–ª—è –æ–∫—Ä—É–∂–Ω–æ–≥–æ —Ö–∞–∫–∞—Ç–æ–Ω–∞ –ü–§–û.
## –ö–æ–º–∞–Ω–¥–∞ 
- **–ì–ª–µ–± –ó–∞–º–∞–ª–µ—Ç–¥–∏–Ω–æ–≤** - –ö–∞–ø–∏—Ç–∞–Ω –∫–æ–º–∞–Ω–¥—ã :crown:
- **–î–∏–º–∞ –ï–ª–∏—Å–µ–µ–≤** - –î–∏–∑–∞–π–Ω–µ—Ä :art:
- **–°–≤—è—Ç–æ—Å–ª–∞–≤ –ë–µ–ª—å–∫–æ–≤—Å–∫–∏–π** - –ò–Ω–∂–µ–Ω–µ—Ä –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç :car:
- **–°–µ—Ä–≥–µ–π –ó–∞—Ö–∞—Ä–æ–≤** - –ò–Ω–∂–µ–Ω–µ—Ä –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç :moyai:
```
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢†‚£ø‚£∂‚£Ñ‚£Ä‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£¥‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∂‚£¶‚£Ñ‚£Ä‚°Ä‚£†‚£æ‚°á‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Äüíó‚†Ä‚†Ä‚£¥‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°á‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£æ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†ø‚†ø‚¢ø‚£ø‚£ø‚°á‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚£∂‚£ø‚£¶‚£ú‚£ø‚£ø‚£ø‚°ü‚†ª‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚¢ø‚°è‚£¥‚£∫‚£¶‚£ô‚£ø‚£∑‚£Ñ‚†Ä‚†Ä‚†Ä
‚†Ä‚£Ø‚°á‚£ª‚£ø‚£ø‚£ø‚£ø‚£∑‚£æ‚£ø‚£¨‚£•‚£≠‚£Ω‚£ø‚£ø‚£ß‚£º‚°á‚£Ø‚£á‚£π‚£ø‚£ø‚£ø‚£ø‚£ß‚†Ä‚†Ä
‚†Ä‚†π‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†∏‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∑
```
## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ :eyes:
1. [–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞](#–æ–ø–∏—Å–∞–Ω–∏–µ-–ø—Ä–æ–µ–∫—Ç–∞)
2. [–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞](#—Ü–µ–ª—å-–ø—Ä–æ–µ–∫—Ç–∞)
3. [–ó–∞–¥–∞—á–∞](#–∑–∞–¥–∞—á–∞)
4. [–°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π](#—Å—Ç–µ–∫-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π)
5. [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö](#–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-–æ–±—Ä–∞–±–æ—Ç–∫–∞-–∫–ª–∏–µ–Ω—Ç–æ–≤-–∏-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π)
6. [–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏](#–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ-–∏-–æ—Ü–µ–Ω–∫–∞-–º–æ–¥–µ–ª–∏-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è-—Ä–∞–Ω–Ω–µ–≥–æ-–≤—ã—Ö–æ–¥–∞-–Ω–∞-–ø–µ–Ω—Å–∏—é)

## –ö–µ–π—Å :briefcase:
–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–Ω–Ω–µ–≥–æ –≤—ã—Ö–æ–¥–∞ –Ω–∞ –ø–µ–Ω—Å–∏—é.

### –ö–µ–π—Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å
–ê–û ¬´–ù–µ–≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–µ–Ω—Å–∏–æ–Ω–Ω—ã–π —Ñ–æ–Ω–¥ ¬´–ë–£–î–£–©–ï–ï¬ª
## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
### –ü—Ä–æ–±–ª–µ–º–∞ :interrobang:
–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ–Ω—Å–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã —Å—Ç–∞–ª–∫–∏–≤–∞—é—Ç—Å—è —Å –≤—ã–∑–æ–≤–∞–º–∏, –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∂–∏–∑–Ω–∏ –∏ —Å–Ω–∏–∂–µ–Ω–∏–µ —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç–∏ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é –Ω–∞–≥—Ä—É–∑–∫—É, —Ç–∞–∫ –∫–∞–∫ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ–Ω—Å–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –¥–æ–ª–∂–Ω—ã –≤—ã–ø–ª–∞—á–∏–≤–∞—Ç—å –ø–µ–Ω—Å–∏–∏ –¥–æ–ª—å—à–µ. –° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –¥–ª—è –Ω–µ–≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–µ–Ω—Å–∏–æ–Ω–Ω—ã—Ö —Ñ–æ–Ω–¥–æ–≤ (–ù–ü–§) —Ä–∞–Ω–Ω–∏–π –≤—ã—Ö–æ–¥ –Ω–∞ –ø–µ–Ω—Å–∏—é –∫–ª–∏–µ–Ω—Ç–æ–≤ —É–º–µ–Ω—å—à–∞–µ—Ç –æ–±—ä–µ–º –≤–∑–Ω–æ—Å–æ–≤ –∏ —á–∏—Å—Ç—É—é –ø—Ä–∏–±—ã–ª—å, –ø–æ—Å–∫–æ–ª—å–∫—É —Å–æ–∫—Ä–∞—â–∞–µ—Ç –≤—Ä–µ–º—è –¥–ª—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

### –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ :black_nib:
–°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –æ—Ü–µ–Ω–∏—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –≤—ã—Ö–æ–¥–∞ –Ω–∞ –ø–µ–Ω—Å–∏—é –∫–ª–∏–µ–Ω—Ç–∞ –û–ü–° –∏–ª–∏ –ù–ü–§. –ú–æ–¥–µ–ª—å –ø–æ–∑–≤–æ–ª–∏—Ç –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å –¥–µ–Ω–µ–∂–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.

 ## –ó–∞–¥–∞—á–∞ :bulb:
–ó–∞–¥–∞—á–∞ –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å, —Å–ø–æ—Å–æ–±–Ω—É—é –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å, –æ–±—Ä–∞—Ç–∏—Ç—Å—è –ª–∏ –∫–ª–∏–µ–Ω—Ç –∑–∞ –¥–æ—Å—Ä–æ—á–Ω–æ–π –ø–µ–Ω—Å–∏–µ–π, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –µ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞—Ö –∏ –º–∞–∫—Ä–æ—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è—Ö. –≠—Ç–æ –∑–Ω–∞–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–º –∏ –Ω–µ–≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–º –ø–µ–Ω—Å–∏–æ–Ω–Ω—ã–º —Ñ–æ–Ω–¥–∞–º:

- —É—á–∏—Ç—ã–≤–∞—Ç—å —Ä–∏—Å–∫–∏ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞,
- –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏,
- —É–∫—Ä–µ–ø–ª—è—Ç—å —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –ø–µ–Ω—Å–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã.

### –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π :computer:


  <img src= "https://i.imgur.com/Y4JublQ.jpg" title="Jupyter Notebook" width="120" height="100"/>&nbsp; <img src="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/python/python-original-wordmark.svg" title="Python" width="100" height="100"/>&nbsp; <img src="https://i.imgur.com/DZ0ilNv.png?1" title="CatBoost" width="120" height="100"/>&nbsp;


## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π :scissors:
 
```
import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from tqdm import tqdm

# –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç–∏ –∫ –∏—Å—Ö–æ–¥–Ω—ã–º —Ñ–∞–π–ª–∞–º
clients_file_path = r"D:\Download\train_dataset_train_data_NPF\train_data\cntrbtrs_clnts_ops_trn.csv"
transactions_file_path = r"D:\Download\train_dataset_train_data_NPF\train_data\trnsctns_ops_trn.csv"
# –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã
predict_data_file_path = r"D:\Download\train_dataset_train_data_NPF\train_data\train1_data.csv"
train_data_file_path = r"D:\Download\train_dataset_train_data_NPF\train_data\predict1_data.csv"

# –ß—Ç–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
clients_df = pd.read_csv(clients_file_path, sep=';', encoding='ANSI', dtype={
    'gndr': 'category',
    'accnt_status': 'category',
    'brth_yr': 'int16',
    'prsnt_age': 'int8',
    'pnsn_age': 'int8'
})

# –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–∞: '–º' = 1, '–∂' = 0
clients_df['gndr'] = clients_df['gndr'].map({'–º': 1, '–∂': 0}).astype('int8')

# –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å—á–µ—Ç–∞: '–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥' = 1, '–í—ã–ø–ª–∞—Ç–Ω–æ–π –ø–µ—Ä–∏–æ–¥' = 0
clients_df['accnt_status'] = clients_df['accnt_status'].map({'–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥': 1, '–í—ã–ø–ª–∞—Ç–Ω–æ–π –ø–µ—Ä–∏–æ–¥': 0}).astype('int8')

# –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–π DataFrame –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
transactions_processed = []

# –ß—Ç–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ —á–∞—Å—Ç—è–º
for chunk in pd.read_csv(transactions_file_path, sep=';', encoding='utf-8', chunksize=100000, dtype={
    'mvmnt_type': 'int8',
    'sum': 'float32'
}):
    # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞—Ç
    chunk['oprtn_date'] = pd.to_datetime(chunk['oprtn_date'], errors='coerce')

    # –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ —Å NaT –≤ 'oprtn_date'
    chunk = chunk.dropna(subset=['oprtn_date'])

    # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ —á–∞–Ω–∫–∞ –≤ —Å–ø–∏—Å–æ–∫
    transactions_processed.append(chunk)

# –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —á–∞—Å—Ç–µ–π –≤ –æ–¥–∏–Ω DataFrame
transactions_df = pd.concat(transactions_processed, ignore_index=True)

# –£–º–µ–Ω—å—à–∞–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏, –ø—Ä–µ–æ–±—Ä–∞–∑—É—è 'oprtn_date' –≤ int
transactions_df['oprtn_date'] = transactions_df['oprtn_date'].astype('int64')

# –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –ø–æ 'accnt_id' —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞ 'outer'
merged_df = pd.merge(clients_df, transactions_df, on='accnt_id', how='left')

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
nmbr_of_trnsltns = merged_df.groupby('clnt_id').size().reset_index(name='nmbr_of_trnsltns')

# –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –∫–æ–ª–æ–Ω–∫—É –¥–ª—è –æ—Ü–µ–Ω–∫–∏
merged_df['transaction_value'] = merged_df['sum'] * np.where(merged_df['mvmnt_type'] == 1, 1, -1)

# –í—ã—á–∏—Å–ª—è–µ–º –æ–±—â—É—é –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–≤–æ–¥–æ–≤
positive_sum = merged_df[merged_df['transaction_value'] > 0].groupby('clnt_id')['transaction_value'].sum().reset_index(name='positive_sum')
negative_sum = merged_df[merged_df['transaction_value'] < 0].groupby('clnt_id')['transaction_value'].sum().reset_index(name='negative_sum')

# –û–±—ä–µ–¥–∏–Ω—è–µ–º –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —Å—É–º–º—ã
trnsltn_vltn = pd.merge(positive_sum, negative_sum, on='clnt_id', how='outer').fillna(0)

# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º trnsltn_vltn –∫–∞–∫ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç 0 –¥–æ 1
trnsltn_vltn['trnsltn_vltn'] = trnsltn_vltn.apply(
    lambda x: round((x['positive_sum'] / (x['positive_sum'] - x['negative_sum'] + 1e-10)), 2) if (x['positive_sum'] + abs(x['negative_sum'])) > 0 else 0, axis=1
)


# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
def calculate_aggregations(group):
    transaction_value = group['transaction_value']
    oprtn_date = group['oprtn_date'].sort_values()
    mvmnt_type = group['mvmnt_type']
    
    result = {
        'avrg_sum': transaction_value.mean(),
        'sum_sum': transaction_value.sum(),
        'min_sum': transaction_value[transaction_value < 0].sum(),
        'max_sum': transaction_value[transaction_value > 0].sum(),
        'lrgst_sum': transaction_value.max(),
        'mnmm_sum': transaction_value.min(),
        'one_for_trnsctn': transaction_value.sum() / len(transaction_value) if len(transaction_value) > 0 else 0,
        'trnsctns_frnqnc': (oprtn_date.diff().mean() / 1e9 if len(oprtn_date) > 1 else np.nan),  # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –¥–Ω–∏
        'trnsctns_frnqnc_max': (oprtn_date.diff().max() / 1e9 if len(oprtn_date) > 1 else np.nan),
        'trnsctns_frnqnc_min': (oprtn_date.diff().min() / 1e9 if len(oprtn_date) > 1 else np.nan),
        'frnqnt_trnsctn': mvmnt_type.mode()[0] if not mvmnt_type.mode().empty else 0,
        'frnqnt_trnsctn_1': (mvmnt_type == 1).sum(),
        'frnqnt_trnsctn_0': (mvmnt_type == 0).sum(),
    }
    return pd.Series(result)

tqdm.pandas(desc="–û–±—Ä–∞–±–æ—Ç–∫–∞ –≥—Ä—É–ø–ø")
aggregated_data = merged_df.groupby('clnt_id').progress_apply(calculate_aggregations).reset_index()

# –û–±—ä–µ–¥–∏–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–≤–æ–¥–æ–≤
aggregated_data = pd.merge(aggregated_data, nmbr_of_trnsltns, on='clnt_id', how='outer')
aggregated_data = pd.merge(aggregated_data, trnsltn_vltn[['clnt_id', 'trnsltn_vltn']], on='clnt_id', how='outer')

# –û–±—ä–µ–¥–∏–Ω—è–µ–º —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏
final_df = pd.merge(clients_df[['clnt_id', 'gndr', 'brth_yr', 'prsnt_age', 'erly_pnsn_flg', 'accnt_status', 'pnsn_age']],
                    aggregated_data, on='clnt_id', how='left')

# –£–¥–∞–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ 'trnsltn_vltn' —è–≤–ª—è–µ—Ç—Å—è NaN
final_df.dropna(subset=['trnsltn_vltn'], inplace=True)

# –£–¥–∞–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –Ω—É–ª–µ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –≤ 'trnsltn_vltn' –ø–æ—Å–ª–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã
final_df = final_df[final_df['trnsltn_vltn'] != 0]

# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏ (70% –Ω–∞ 30%)
train_df, predict_df = train_test_split(final_df, test_size=0.3, random_state=42)

# –£–¥–∞–ª—è–µ–º —Å—Ç–æ–ª–±–µ—Ü clnt_id —É –ø—Ä–µ–¥–∏–∫—Ç–∞ –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
train_df.drop(columns=['clnt_id'], inplace=True)
predict_df.drop(columns=['clnt_id'], inplace=True)

# –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ erly_pnsn_flg –≤ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ
count_1 = train_df['erly_pnsn_flg'].value_counts().get(1, 0)
train_df_0 = train_df[train_df['erly_pnsn_flg'] == 0].sample(n=count_1, random_state=42)
train_df_1 = train_df[train_df['erly_pnsn_flg'] == 1]
train_df_balanced = pd.concat([train_df_0, train_df_1])

# –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤—ã–±–æ—Ä–∫—É
train_df_balanced = train_df_balanced.sample(frac=1, random_state=42).reset_index(drop=True)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü –≤ CSV
train_df_balanced.to_csv(train_data_file_path, index=False, encoding='utf-8', sep=';')
predict_df.to_csv(predict_data_file_path, index=False, encoding='utf-8', sep=';')

print("–ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω—ã –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ø–æ –ø—É—Ç–∏:")
print(train_data_file_path)
print(predict_data_file_path)
```
|–ê—Ä–≥—É–º–µ–Ω—Ç  |	–û–ø–∏—Å–∞–Ω–∏–µ|
|----------|---------|
|avrg_sum	 | –°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞ sum –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è).|
|sum_sum	  |–û–±—â–∞—è —Å—É–º–º–∞ –≤—Å–µ—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å—É–º–º–∞ –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ sum).|
|min_sum	  |–°—É–º–º–∞ –≤—Å–µ—Ö –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å—É–º–º–∞ –≤—Å–µ—Ö –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ sum).|
|max_sum	  |–°—É–º–º–∞ –≤—Å–µ—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å—É–º–º–∞ –≤—Å–µ—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ sum).|
|lrgst_sum	|–ù–∞–∏–±–æ–ª—å—à–∞—è —Å—É–º–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ sum —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π).|
|mnmm_sum	|–ù–∞–∏–º–µ–Ω—å—à–∞—è —Å—É–º–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ sum —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π).|
|one_for_trnsctn |	–°—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∞ –Ω–∞ –æ–¥–Ω—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é (—Å—É–º–º–∞ sum –¥–µ–ª–µ–Ω–Ω–∞—è –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ nmbr_of_trnsltns).|
|trnsctns_frnqnc	| –°—Ä–µ–¥–Ω–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏ –≤ –¥–Ω—è—Ö (—Ä–∞–∑ –≤ —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –±—ã–ª–∏ –ø–µ—Ä–µ–≤–æ–¥—ã, –≤ —Å—Ä–µ–¥–Ω–µ–º, –ø–æ oprtn_date).|
|trnsctns_frnqnc_max |	–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª (–≤ –¥–Ω—è—Ö) –º–µ–∂–¥—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ (—Å–∞–º—ã–π –±–æ–ª—å—à–æ–π –ø–µ—Ä–µ—Ä—ã–≤ –ø–æ oprtn_date).|
|trnsctns_frnqnc_min	| –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª (–≤ –¥–Ω—è—Ö) –º–µ–∂–¥—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ (—Å–∞–º—ã–π –º–∞–ª–µ–Ω—å–∫–∏–π –ø–µ—Ä–µ—Ä—ã–≤ –ø–æ oprtn_date).|
|frnqnt_trnsctn	| –ù–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç—ã–π —Ç–∏–ø –¥–≤–∏–∂–µ–Ω–∏—è –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ (1 –∏–ª–∏ 0, –ø–æ mvmnt_type).|
|frnqnt_trnsctn_1	| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å –¥–≤–∏–∂–µ–Ω–∏–µ–º –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ 1 (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü –≤ mvmnt_type).|
|frnqnt_trnsctn_0	| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å –¥–≤–∏–∂–µ–Ω–∏–µ–º –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ 0 (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω—É–ª–µ–π –≤ mvmnt_type).|

### –ê–Ω–∞–ª–∏–∑ —Ä–∞–±–æ—Ç—ã –∫–æ–¥–∞

–≠—Ç–æ—Ç –∫–æ–¥ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –≤—ã—Ö–æ–¥–∞ –Ω–∞ –ø–µ–Ω—Å–∏—é. –û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã –≤–∫–ª—é—á–∞—é—Ç –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, —Ä–∞—Å—á–µ—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤, –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º, –∞ —Ç–∞–∫–∂–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏ —Å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–æ–π —Ü–µ–ª–µ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞. –°–∫—Ä–∏–ø—Ç –∑–∞–≤–µ—Ä—à–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ CSV-—Ñ–∞–π–ª—ã –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞. 
–î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –±–æ–ª—å—à–∏–º–∏ –º–∞—Å—Å–∏–≤–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–µ—Ç–æ–¥—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ –ø–æ—ç—Ç–∞–ø–Ω–æ–µ —á—Ç–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —á–∞–Ω–∫–∞–º–∏, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö, –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ tqdm –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø—Ä–∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

## –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ä–∞–Ω–Ω–µ–≥–æ –≤—ã—Ö–æ–¥–∞ –Ω–∞ –ø–µ–Ω—Å–∏—é :pushpin:

```
# –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫
import pandas as pd
from catboost import CatBoostClassifier
from sklearn.model_selection import train_test_split, cross_val_score
from sklearn.metrics import accuracy_score, f1_score, precision_score, recall_score, confusion_matrix

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV
data = pd.read_csv(r"D:\Download\train_dataset_train_data_NPF\train_data\train1_data.csv", encoding='utf-8', sep=';')  # –í—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è

# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
feature_columns = ['gndr', 'brth_yr', 'prsnt_age', 'accnt_status', 'pnsn_age', 
                   'avrg_sum', 'sum_sum', 'min_sum', 'max_sum', 'lrgst_sum', 
                   'mnmm_sum', 'one_for_trnsctn', 'trnsctns_frnqnc', 
                   'trnsctns_frnqnc_max', 'trnsctns_frnqnc_min', 
                   'frnqnt_trnsctn', 'frnqnt_trnsctn_1', 'frnqnt_trnsctn_0', 
                   'nmbr_of_trnsltns', 'trnsltn_vltn']
X = data[feature_columns]  # –ü—Ä–∏–∑–Ω–∞–∫–∏
y = data['erly_pnsn_flg']  # –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è

# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
model = CatBoostClassifier(iterations=1000, learning_rate=0.1, depth=6, eval_metric='Accuracy', verbose=100)
model.fit(X_train, y_train, eval_set=(X_test, y_test), use_best_model=True)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
model.save_model(r"D:\Download\train_dataset_train_data_NPF\train_data\catboost_model.cbm")  # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –≤ —Ñ–∞–π–ª

# –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
y_pred = model.predict(X_test)
accuracy = accuracy_score(y_test, y_pred)
f1 = f1_score(y_test, y_pred)
precision = precision_score(y_test, y_pred)
recall = recall_score(y_test, y_pred)
conf_matrix = confusion_matrix(y_test, y_pred)

print(f"–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: {accuracy:.2f}")
print(f"F1-Score: {f1:.2f}")
print(f"Precision: {precision:.2f}")
print(f"Recall: {recall:.2f}")
print("–ú–∞—Ç—Ä–∏—Ü–∞ –ø—É—Ç–∞–Ω–∏—Ü—ã:\n", conf_matrix)

# –ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è
cv_scores = cross_val_score(model, X, y, cv=5, scoring='accuracy')
print(f"–°—Ä–µ–¥–Ω—è—è —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–∏ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏: {cv_scores.mean():.2f} ¬± {cv_scores.std():.2f}")

# –ü—Ä–æ–≥–Ω–æ–∑ –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª —Å —ç—Ç–∞–ª–æ–Ω–æ–º)
new_data = pd.read_csv(r"D:\Download\train_dataset_train_data_NPF\train_data\predict1_data.csv", encoding='utf-8', sep=';')  # –í—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
if all(col in new_data.columns for col in feature_columns):
    new_data_predictions = model.predict(new_data[feature_columns])  # –ü—Ä–æ–≥–Ω–æ–∑

    # –ï—Å–ª–∏ –≤ new_data –µ—Å—Ç—å –∏—Å—Ç–∏–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –æ—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    if 'erly_pnsn_flg' in new_data.columns:
        y_true = new_data['erly_pnsn_flg']  # –ò—Å—Ç–∏–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
        new_accuracy = accuracy_score(y_true, new_data_predictions)
        new_f1 = f1_score(y_true, new_data_predictions)
        new_precision = precision_score(y_true, new_data_predictions)
        new_recall = recall_score(y_true, new_data_predictions)
        new_conf_matrix = confusion_matrix(y_true, new_data_predictions)

        print(f"–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: {new_accuracy:.2f}")
        print(f"F1-Score –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: {new_f1:.2f}")
        print(f"Precision –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: {new_precision:.2f}")
        print(f"Recall –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: {new_recall:.2f}")
        print("–ú–∞—Ç—Ä–∏—Ü–∞ –ø—É—Ç–∞–Ω–∏—Ü—ã –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö:\n", new_conf_matrix)

        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –≤ CSV
        output = new_data.copy()
        output['predicted_erly_pnsn_flg'] = new_data_predictions  # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –≤ –≤—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª
        output.to_csv(r"D:\Download\train_dataset_train_data_NPF\train_data\VALID_data.csv", index=False)  # –í—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏
    else:
        print("–í —Ñ–∞–π–ª–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–æ–ª–±–µ—Ü 'erly_pnsn_flg' –¥–ª—è —Å–≤–µ—Ä–∫–∏.")
else:
    print("–í —Ñ–∞–π–ª–µ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å—Ç–æ–ª–±—Ü—ã –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è.")

```
### –ê–Ω–∞–ª–∏–∑ —Ä–∞–±–æ—Ç—ã –∫–æ–¥–∞

–≠—Ç–æ—Ç –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É CatBoost –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É—é—â–µ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ä–∞–Ω–Ω–µ–≥–æ –≤—ã—Ö–æ–¥–∞ –Ω–∞ –ø–µ–Ω—Å–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤. –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞, –∞ –∑–∞—Ç–µ–º –¥–µ–ª—è—Ç—Å—è –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏. –ú–æ–¥–µ–ª—å CatBoostClassifier –æ–±—É—á–∞–µ—Ç—Å—è —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –º–µ—Ç—Ä–∏–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è. –ò—Ç–æ–≥–æ–≤—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ CSV-—Ñ–∞–π–ª –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.

## –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –∫–æ–¥–∞ 
```
0:  learn: 0.9992850  test: 0.9996425  best: 0.9996425 (0)  total: 63.3ms  remaining: 1m 3s
100:  learn: 1.0000000  test: 0.9999404  best: 0.9999404 (5)  total: 1.1s  remaining: 9.77s
200:  learn: 1.0000000  test: 0.9999404  best: 0.9999404 (5)  total: 2s  remaining: 7.97s
300:  learn: 1.0000000  test: 0.9999404  best: 0.9999404 (5)  total: 2.73s  remaining: 6.34s
400:  learn: 1.0000000  test: 0.9999404  best: 0.9999404 (5)  total: 3.51s  remaining: 5.25s
500:  learn: 1.0000000  test: 0.9999404  best: 0.9999404 (5)  total: 4.22s  remaining: 4.2s
600:  learn: 1.0000000  test: 0.9999404  best: 0.9999404 (5)  total: 5.03s  remaining: 3.34s
700:  learn: 1.0000000  test: 0.9999404  best: 0.9999404 (5)  total: 5.85s  remaining: 2.49s
800:  learn: 1.0000000  test: 0.9999404  best: 0.9999404 (5)  total: 6.7s  remaining: 1.66s
900:  learn: 1.0000000  test: 0.9999404  best: 0.9999404 (5)  total: 7.54s  remaining: 829ms
999:  learn: 1.0000000  test: 0.9999404  best: 0.9999404 (5)  total: 8.24s  remaining: 0us

bestTest = 0.9999404159
bestIteration = 5

Shrink model to first 6 iterations.
–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: 1.00
F1-Score: 1.00
Precision: 1.00
Recall: 1.00
–ú–∞—Ç—Ä–∏—Ü–∞ –ø—É—Ç–∞–Ω–∏—Ü—ã:
 [[16294     0]
 [    1   488]]
```
```
–°—Ä–µ–¥–Ω—è—è —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–∏ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏: 1.00 ¬± 0.00
–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: 0.99
F1-Score –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: 0.99
Precision –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: 1.00
Recall –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: 0.98
–ú–∞—Ç—Ä–∏—Ü–∞ –ø—É—Ç–∞–Ω–∏—Ü—ã –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
 [[5986    0]
 [ 101 5885]]
```
