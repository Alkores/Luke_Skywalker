# Luke_Skywalker
–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –∫–æ–º–∞–Ω–¥–æ–π Luke_Skywalker –¥–ª—è –æ–∫—Ä—É–∂–Ω–æ–≥–æ —Ö–∞–∫–∞—Ç–æ–Ω–∞ –ü–§–û.
```
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢†‚£ø‚£∂‚£Ñ‚£Ä‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£¥‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∂‚£¶‚£Ñ‚£Ä‚°Ä‚£†‚£æ‚°á‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Äüíó‚†Ä‚†Ä‚£¥‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°á‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£æ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†ø‚†ø‚¢ø‚£ø‚£ø‚°á‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚£∂‚£ø‚£¶‚£ú‚£ø‚£ø‚£ø‚°ü‚†ª‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚¢ø‚°è‚£¥‚£∫‚£¶‚£ô‚£ø‚£∑‚£Ñ‚†Ä‚†Ä‚†Ä
‚†Ä‚£Ø‚°á‚£ª‚£ø‚£ø‚£ø‚£ø‚£∑‚£æ‚£ø‚£¨‚£•‚£≠‚£Ω‚£ø‚£ø‚£ß‚£º‚°á‚£Ø‚£á‚£π‚£ø‚£ø‚£ø‚£ø‚£ß‚†Ä‚†Ä
‚†Ä‚†π‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†∏‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∑
```
## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞](#–æ–ø–∏—Å–∞–Ω–∏–µ-–ø—Ä–æ–µ–∫—Ç–∞)
2. [–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞](#—Ü–µ–ª—å-–ø—Ä–æ–µ–∫—Ç–∞)
3. [–ó–∞–¥–∞—á–∞](#–∑–∞–¥–∞—á–∞)
4. [–°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π](#—Å—Ç–µ–∫-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π)
5. [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö](#–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-–æ–±—Ä–∞–±–æ—Ç–∫–∞-–∫–ª–∏–µ–Ω—Ç–æ–≤-–∏-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π)
6. [–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏](#–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ-–∏-–æ—Ü–µ–Ω–∫–∞-–º–æ–¥–µ–ª–∏-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è-—Ä–∞–Ω–Ω–µ–≥–æ-–≤—ã—Ö–æ–¥–∞-–Ω–∞-–ø–µ–Ω—Å–∏—é)
7. [–ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –∞–≤—Ç–æ—Ä—ã](#–∫–æ–Ω—Ç–∞–∫—Ç—ã-–∏-–∞–≤—Ç–æ—Ä—ã)

## –ö–µ–π—Å
–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–Ω–Ω–µ–≥–æ –≤—ã—Ö–æ–¥–∞ –Ω–∞ –ø–µ–Ω—Å–∏—é.

### –ö–µ–π—Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å
–ê–û ¬´–ù–µ–≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–µ–Ω—Å–∏–æ–Ω–Ω—ã–π —Ñ–æ–Ω–¥ ¬´–ë–£–î–£–©–ï–ï¬ª
## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
### –ü—Ä–æ–±–ª–µ–º–∞
–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ–Ω—Å–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã —Å—Ç–∞–ª–∫–∏–≤–∞—é—Ç—Å—è —Å –≤—ã–∑–æ–≤–∞–º–∏, –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∂–∏–∑–Ω–∏ –∏ —Å–Ω–∏–∂–µ–Ω–∏–µ —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç–∏ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é –Ω–∞–≥—Ä—É–∑–∫—É, —Ç–∞–∫ –∫–∞–∫ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ–Ω—Å–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –¥–æ–ª–∂–Ω—ã –≤—ã–ø–ª–∞—á–∏–≤–∞—Ç—å –ø–µ–Ω—Å–∏–∏ –¥–æ–ª—å—à–µ. –° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –¥–ª—è –Ω–µ–≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–µ–Ω—Å–∏–æ–Ω–Ω—ã—Ö —Ñ–æ–Ω–¥–æ–≤ (–ù–ü–§) —Ä–∞–Ω–Ω–∏–π –≤—ã—Ö–æ–¥ –Ω–∞ –ø–µ–Ω—Å–∏—é –∫–ª–∏–µ–Ω—Ç–æ–≤ —É–º–µ–Ω—å—à–∞–µ—Ç –æ–±—ä–µ–º –≤–∑–Ω–æ—Å–æ–≤ –∏ —á–∏—Å—Ç—É—é –ø—Ä–∏–±—ã–ª—å, –ø–æ—Å–∫–æ–ª—å–∫—É —Å–æ–∫—Ä–∞—â–∞–µ—Ç –≤—Ä–µ–º—è –¥–ª—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

### –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
–°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –æ—Ü–µ–Ω–∏—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –≤—ã—Ö–æ–¥–∞ –Ω–∞ –ø–µ–Ω—Å–∏—é –∫–ª–∏–µ–Ω—Ç–∞ –û–ü–° –∏–ª–∏ –ù–ü–§. –ú–æ–¥–µ–ª—å –ø–æ–∑–≤–æ–ª–∏—Ç –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å –¥–µ–Ω–µ–∂–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.

 ## –ó–∞–¥–∞—á–∞
–ó–∞–¥–∞—á–∞ –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å, —Å–ø–æ—Å–æ–±–Ω—É—é –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å, –æ–±—Ä–∞—Ç–∏—Ç—Å—è –ª–∏ –∫–ª–∏–µ–Ω—Ç –∑–∞ –¥–æ—Å—Ä–æ—á–Ω–æ–π –ø–µ–Ω—Å–∏–µ–π, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –µ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞—Ö –∏ –º–∞–∫—Ä–æ—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è—Ö. –≠—Ç–æ –∑–Ω–∞–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–º –∏ –Ω–µ–≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–º –ø–µ–Ω—Å–∏–æ–Ω–Ω—ã–º —Ñ–æ–Ω–¥–∞–º:

- —É—á–∏—Ç—ã–≤–∞—Ç—å —Ä–∏—Å–∫–∏ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞,
- –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏,
- —É–∫—Ä–µ–ø–ª—è—Ç—å —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –ø–µ–Ω—Å–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã.

### –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

  <img src="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/python/python-original-wordmark.svg" title="Python" width="50" height="50"/>&nbsp;
  <img src="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/jupyter/jupyter-original-wordmark.svg" title="Jupyter Notebook" width="50" height="50"/>&nbsp;
          
          

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

```
import pandas as pd
from sklearn.model_selection import train_test_split

# –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç–∏ –∫ –∏—Å—Ö–æ–¥–Ω—ã–º —Ñ–∞–π–ª–∞–º
clients_file_path = r"D:\Download\train_dataset_train_data_NPF\train_data\cntrbtrs_clnts_ops_trn.csv"
transactions_file_path = r"D:\Download\train_dataset_train_data_NPF\train_data\trnsctns_ops_trn.csv"
# –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã
train_data_file_path = r"D:\Download\train_dataset_train_data_NPF\train_data\train_data.csv"
predict_data_file_path = r"D:\Download\train_dataset_train_data_NPF\train_data\predict_data.csv"

# –ß—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ CSV
clients_df = pd.read_csv(clients_file_path, sep=';', encoding='ANSI')
transactions_df = pd.read_csv(transactions_file_path, sep=';', encoding='utf-8')

# –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–∞: '–º' = 1, '–∂' = 0
clients_df['gndr'] = clients_df['gndr'].replace({'–º': 1, '–∂': 0})

# –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å—á–µ—Ç–∞: '–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥' = 1, '–í—ã–ø–ª–∞—Ç–Ω–æ–π –ø–µ—Ä–∏–æ–¥' = 0
clients_df['accnt_status'] = clients_df['accnt_status'].replace({'–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥': 1, '–í—ã–ø–ª–∞—Ç–Ω–æ–π –ø–µ—Ä–∏–æ–¥': 0})

# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ —Å null –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –∫–ª–∏–µ–Ω—Ç–æ–≤
clients_df.dropna(inplace=True)

# –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –ø–æ 'accnt_id'
merged_df = pd.merge(clients_df, transactions_df, on='accnt_id', how='left')

# –£–¥–∞–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏ —Å null –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö
merged_df.dropna(subset=['sum'], inplace=True)

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
nmbr_of_trnsltns = merged_df.groupby('clnt_id').size().reset_index(name='nmbr_of_trnsltns')

# –ü—Ä–∏–≤–æ–¥–∏–º —Ç–∏–ø –∫ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–º—É –ø–æ—Å–ª–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
nmbr_of_trnsltns['nmbr_of_trnsltns'] = nmbr_of_trnsltns['nmbr_of_trnsltns'].astype(int)

# –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –∫–æ–ª–æ–Ω–∫—É –¥–ª—è –æ—Ü–µ–Ω–∫–∏
merged_df['transaction_value'] = merged_df.apply(
    lambda x: x['sum'] if x['mvmnt_type'] == 1 else -x['sum'], axis=1
)

# –£–¥–∞–ª—è–µ–º –Ω—É–ª–µ–≤—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã
filtered_transactions = merged_df[merged_df['sum'] != 0]

# –í—ã—á–∏—Å–ª—è–µ–º –æ–±—â—É—é –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–≤–æ–¥–æ–≤
# –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —Å—É–º–º—ã
positive_sum = filtered_transactions[filtered_transactions['transaction_value'] > 0].groupby('clnt_id')['transaction_value'].sum().reset_index(name='positive_sum')
negative_sum = filtered_transactions[filtered_transactions['transaction_value'] < 0].groupby('clnt_id')['transaction_value'].sum().reset_index(name='negative_sum')

# –û–±—ä–µ–¥–∏–Ω—è–µ–º –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —Å—É–º–º—ã
trnsltn_vltn = pd.merge(positive_sum, negative_sum, on='clnt_id', how='left').fillna(0)

# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º trnsltn_vltn –∫–∞–∫ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç 0 –¥–æ 1
trnsltn_vltn['trnsltn_vltn'] = trnsltn_vltn.apply(
    lambda x: round((x['positive_sum'] / (x['positive_sum'] - x['negative_sum'] + 1e-10)), 2) if (x['positive_sum'] + abs(x['negative_sum'])) > 0 else 0, axis=1
)

# –£–¥–∞–ª—è–µ–º –∫–ª–∏–µ–Ω—Ç–æ–≤ –±–µ–∑ –ø–µ—Ä–µ–≤–æ–¥–æ–≤
trnsltn_vltn = trnsltn_vltn[(trnsltn_vltn['positive_sum'] > 0) | (trnsltn_vltn['negative_sum'] > 0)]

# –û–±—ä–µ–¥–∏–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–≤–æ–¥–æ–≤
result_df = pd.merge(nmbr_of_trnsltns, trnsltn_vltn[['clnt_id', 'trnsltn_vltn']], on='clnt_id', how='left')

# –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ nmbr_of_trnsltns —è–≤–ª—è–µ—Ç—Å—è —Ü–µ–ª—ã–º —á–∏—Å–ª–æ–º
result_df['nmbr_of_trnsltns'] = result_df['nmbr_of_trnsltns'].astype(int)

# –û–±—ä–µ–¥–∏–Ω—è–µ–º —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏
final_df = pd.merge(clients_df[['clnt_id', 'gndr', 'brth_yr', 'prsnt_age', 'erly_pnsn_flg', 'accnt_status', 'pnsn_age']],
                    result_df, on='clnt_id', how='left')

# –£–¥–∞–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ trnsltn_vltn —è–≤–ª—è–µ—Ç—Å—è NaN
final_df.dropna(subset=['trnsltn_vltn'], inplace=True)

# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏ (70% –Ω–∞ 30%)
train_df, predict_df = train_test_split(final_df, test_size=0.3, random_state=42)

# –£–¥–∞–ª—è–µ–º —Å—Ç–æ–ª–±–µ—Ü erly_pnsn_flg —É –ø—Ä–µ–¥–∏–∫—Ç–∞
predict_df.drop(columns=['erly_pnsn_flg'], inplace=True)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü –≤ CSV
train_df.to_csv(train_data_file_path, index=False, encoding='utf-8', sep=';')
predict_df.to_csv(predict_data_file_path, index=False, encoding='utf-8', sep=';')

print("–ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω—ã –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ø–æ –ø—É—Ç–∏:")
print(train_data_file_path)
print(predict_data_file_path)
```
### –ê–Ω–∞–ª–∏–∑ —Ä–∞–±–æ—Ç—ã –∫–æ–¥–∞

–≠—Ç–æ—Ç –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –∫–ª–∏–µ–Ω—Ç–∞—Ö –∏ –∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö –¥–ª—è –∑–∞–¥–∞—á–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ä–∞–Ω–Ω–µ–≥–æ –≤—ã—Ö–æ–¥–∞ –Ω–∞ –ø–µ–Ω—Å–∏—é. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤–∫–ª—é—á–∞—é—Ç –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—É–º–º –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –∞ —Ç–∞–∫–∂–µ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –æ—Ç—Ä–∞–∂–∞—é—â–∏—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤. –§–∏–Ω–∞–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç —Ä–∞–∑–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∏ –æ—Ü–µ–Ω–∫–∏ –º–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

## –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ä–∞–Ω–Ω–µ–≥–æ –≤—ã—Ö–æ–¥–∞ –Ω–∞ –ø–µ–Ω—Å–∏—é

```
# –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫
import pandas as pd
from catboost import CatBoostClassifier
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV
data = pd.read_csv("train_data.csv", encoding='utf-8', sep=';')  # –í—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è

# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
feature_columns = ['gndr', 'brth_yr', 'prsnt_age', 'accnt_status', 'pnsn_age', 'nmbr_of_trnsltns', 'trnsltn_vltn']
X = data[feature_columns]  # –ü—Ä–∏–∑–Ω–∞–∫–∏
y = data['erly_pnsn_flg']  # –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è

# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
model = CatBoostClassifier(iterations=1000, learning_rate=0.1, depth=6, eval_metric='Accuracy', verbose=100)
model.fit(X_train, y_train, eval_set=(X_test, y_test), use_best_model=True)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
model.save_model("catboost_model.cbm")  # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –≤ —Ñ–∞–π–ª

# –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
y_pred = model.predict(X_test)
accuracy = accuracy_score(y_test, y_pred)
print(f"–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: {accuracy:.2f}")

# –ü—Ä–æ–≥–Ω–æ–∑ –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª —Å —ç—Ç–∞–ª–æ–Ω–æ–º)
new_data = pd.read_csv("predict1_data.csv", encoding='utf-8', sep=';')  # –í—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è

# –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ –≤ new_data –µ—Å—Ç—å —Å—Ç–æ–ª–±–µ—Ü 'erly_pnsn_flg' –¥–ª—è —Å–≤–µ—Ä–∫–∏
if 'erly_pnsn_flg' in new_data.columns:
    y_true = new_data['erly_pnsn_flg']  # –ò—Å—Ç–∏–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    new_data_predictions = model.predict(new_data[feature_columns])  # –ü—Ä–æ–≥–Ω–æ–∑

    # –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    new_accuracy = accuracy_score(y_true, new_data_predictions)
    print(f"–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: {new_accuracy:.2f}")

    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –≤ CSV
    output = new_data.copy()
    output['predicted_erly_pnsn_flg'] = new_data_predictions  # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –≤ –≤—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª
    output.to_csv("VALID_data.csv", index=False)  # –í—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏
else:
    print("–í —Ñ–∞–π–ª–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–æ–ª–±–µ—Ü 'erly_pnsn_flg' –¥–ª—è —Å–≤–µ—Ä–∫–∏.")
```
### –ê–Ω–∞–ª–∏–∑ —Ä–∞–±–æ—Ç—ã –∫–æ–¥–∞

–≠—Ç–æ—Ç –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É CatBoost –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É—é—â–µ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ä–∞–Ω–Ω–µ–≥–æ –≤—ã—Ö–æ–¥–∞ –Ω–∞ –ø–µ–Ω—Å–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤. –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞, –∞ –∑–∞—Ç–µ–º –¥–µ–ª—è—Ç—Å—è –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏. –ú–æ–¥–µ–ª—å CatBoostClassifier –æ–±—É—á–∞–µ—Ç—Å—è —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –º–µ—Ç—Ä–∏–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è. –ò—Ç–æ–≥–æ–≤—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ CSV-—Ñ–∞–π–ª –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.
